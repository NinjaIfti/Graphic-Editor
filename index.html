<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Title</title>
    <link href="/css/app.css" rel="stylesheet" />
  </head>
  <body>
    <!-- Context Menu (Alpine.js Component) -->
    <div
      x-data="contextMenu"
      x-show="isOpen"
      x-cloak
      @click.away="close"
      :style="`top: ${posY}px; left: ${posX}px;`"
      class="fixed bg-gray-800 text-white rounded shadow-lg z-50 w-64 overflow-hidden"
    >
      <ul class="py-1">
        <!-- Forward -->
        <li
          @click="handleAction('bringForward')"
          class="px-4 py-2 flex items-center justify-between hover:bg-gray-700 cursor-pointer"
        >
          <div class="flex items-center space-x-2">
            <svg
              class="w-5 h-5 text-gray-200"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 -960 960 960"
            >
              <path
                fill="currentColor"
                d="M480-528 296-344l-56-56 240-240 240 240-56 56-184-184Z"
              />
            </svg>
            <span>Forward</span>
          </div>
          <div class="text-xs text-gray-400">ctrl + [</div>
        </li>

        <!-- Backward -->
        <li
          @click="handleAction('sendBackwards')"
          class="px-4 py-2 flex items-center justify-between hover:bg-gray-700 cursor-pointer"
        >
          <div class="flex items-center space-x-2">
            <svg
              class="w-5 h-5 text-gray-200"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 -960 960 960"
            >
              <path
                fill="currentColor"
                d="M480-333 240-573l51-51 189 189 189-189 51 51-240 240Z"
              />
            </svg>
            <span>Backward</span>
          </div>
          <div class="text-xs text-gray-400">ctrl + ]</div>
        </li>

        <hr class="border-gray-600 my-1" />

        <!-- Lock/Unlock -->
        <li
          @click="toggleLock"
          class="px-4 py-2 flex items-center justify-between hover:bg-gray-700 cursor-pointer"
        >
          <div class="flex items-center space-x-2">
            <svg
              x-show="!isLocked"
              class="w-4 h-4 text-gray-200"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 -960 960 960"
            >
              <path
                fill="currentColor"
                d="M240-80q-33 0-56.5-23.5T160-160v-400q0-33 23.5-56.5T240-640h40v-80q0-83 58.5-141.5T480-920q83 0 141.5 58.5T680-720v80h40q33 0 56.5 23.5T800-560v400q0 33-23.5 56.5T720-80H240Zm0-80h480v-400H240v400Zm240-120q33 0 56.5-23.5T560-360q0-33-23.5-56.5T480-440q-33 0-56.5 23.5T400-360q0 33 23.5 56.5T480-280ZM360-640h240v-80q0-50-35-85t-85-35q-50 0-85 35t-35 85v80ZM240-160v-400 400Z"
              />
            </svg>
            <svg
              x-show="isLocked"
              class="w-4 h-4 text-gray-200"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 -960 960 960"
            >
              <path
                fill="currentColor"
                d="M240-640h360v-80q0-50-35-85t-85-35q-50 0-85 35t-35 85h-80q0-83 58.5-141.5T480-920q83 0 141.5 58.5T680-720v80h40q33 0 56.5 23.5T800-560v400q0 33-23.5 56.5T720-80H240q-33 0-56.5-23.5T160-160v-400q0-33 23.5-56.5T240-640Zm0 480h480v-400H240v400Zm240-120q33 0 56.5-23.5T560-360q0-33-23.5-56.5T480-440q-33 0-56.5 23.5T400-360q0 33 23.5 56.5T480-280ZM240-160v-400 400Z"
              />
            </svg>
            <span x-text="isLocked ? 'Unlock' : 'Lock'"></span>
          </div>
          <div class="text-xs text-gray-400">ctrl + L</div>
        </li>

        <!-- Group/Ungroup -->
        <li
          @click="toggleGroup"
          class="px-4 py-2 flex items-center justify-between hover:bg-gray-700 cursor-pointer"
        >
          <div class="flex items-center space-x-2">
            <svg
              x-show="!isGrouped"
              class="w-4 h-4 text-gray-200"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
            >
              <path
                fill="currentColor"
                d="M20 17.05A2.5 2.5 0 1 1 17.05 20H6.95A2.5 2.5 0 1 1 4 17.05V6.95A2.5 2.5 0 1 1 6.95 4h10.1A2.5 2.5 0 1 1 20 6.95v10.1zm-1.5.16V6.79a2.5 2.5 0 0 1-1.3-1.29H6.8a2.5 2.5 0 0 1-1.3 1.3v10.4a2.5 2.5 0 0 1 1.3 1.3h10.4a2.5 2.5 0 0 1 1.3-1.3zM4.5 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 15a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm15-15a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 15a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-9-6.5a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7zm0-1.5a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm4.75-2.5h1.5v5c0 .97-.78 1.75-1.75 1.75h-5v-1.5h5c.14 0 .25-.11.25-.25v-5z"
              />
            </svg>
            <svg
              x-show="isGrouped"
              class="w-4 h-4 text-gray-200"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
            >
              <path
                fill="currentColor"
                d="M17 9h3v11H9v-3c.51 0 1.01-.05 1.5-.14v1.64h8v-8h-1.64c.1-.49.14-.99.14-1.5zm-8 6A6 6 0 1 1 9 3a6 6 0 0 1 0 12zm0-1.5a4.5 4.5 0 1 0 0-9 4.5 4.5 0 0 0 0 9z"
              />
            </svg>
            <span x-text="isGrouped ? 'Un Group' : 'Group'"></span>
          </div>
          <div class="text-xs text-gray-400">ctrl + G</div>
        </li>

        <hr class="border-gray-600 my-1" />

        <!-- Delete -->
        <li
          @click="handleAction('delete')"
          class="px-4 py-2 flex items-center justify-between hover:bg-gray-700 cursor-pointer"
        >
          <div class="flex items-center space-x-2">
            <svg
              class="w-4 h-4 text-gray-200"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 448 512"
            >
              <path
                fill="currentColor"
                d="M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1 -32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1 -32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1 -32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.7 23.7 0 0 0 -21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0 -16-16z"
              />
            </svg>
            <span>Delete</span>
          </div>
          <div class="text-xs text-gray-400">Del</div>
        </li>
      </ul>
    </div>
    <!-- Navbar -->
    <div class="bg-white shadow-md px-4 py-3 flex items-center justify-between">
      <div class="flex items-center justify-between w-full">
        <!-- Logo Section -->
        <h4 class="text-lg font-semibold text-gray-800">Steve Editor</h4>

        <div class="flex gap-3">
          <!-- Export Buttons -->
          <button
            @click="downloadCanvas('png')"
            class="flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-100 transition-colors"
          >
            <svg
              class="w-4 h-4 text-gray-700"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 -960 960 960"
            >
              <path
                fill="currentColor"
                d="M444-192v-438L243-429l-51-51 288-288 288 288-51 51-201-201v438h-72Z"
              />
            </svg>
            <span class="text-gray-800">PNG</span>
          </button>

          <button
            @click="downloadCanvas('jpg')"
            class="flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-100 transition-colors"
          >
            <svg
              class="w-4 h-4 text-gray-700"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 -960 960 960"
            >
              <path
                fill="currentColor"
                d="M444-192v-438L243-429l-51-51 288-288 288 288-51 51-201-201v438h-72Z"
              />
            </svg>
            <span class="text-gray-800">JPG</span>
          </button>
        </div>
      </div>
    </div>
    <!--Editor-->
    <div class="flex h-[calc(100%-55px)]">
      <!--Sidebar wrapper-->
      <div class="flex gap-[10px]">
        <!-- Mini Bar -->
        <div
          x-data="{ activeTool: 'templates' }"
          class="bg-white flex flex-col max-w-[90px] py-4 pb-[10px] h-full relative justify-between z-[99] shadow-md border-t border-gray-300"
        >
          <!-- Items -->
          <div class="flex flex-col overflow-y-auto scrollbar-hide">
            <!-- Templates -->
            <div
              @click="activeTool = 'templates'; $dispatch('change-tool', { type: 'templates' }); window.dispatchEvent(new CustomEvent('tool-changed', { detail: { type: 'templates' } }));"
              :class="activeTool === 'templates' ? 'bg-gray-100' : ''"
              class="flex flex-col items-center py-3 px-2 cursor-pointer hover:bg-gray-50"
            >
              <div class="mb-1">
                <svg
                  class="w-[21px] h-[21px] text-gray-800"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    fill-rule="evenodd"
                    clip-rule="evenodd"
                    d="M3 11.325c0-3.59 0-5.385.966-6.61a4.5 4.5 0 0 1 .748-.749C5.94 3 7.734 3 11.325 3h1.35c3.59 0 5.386 0 6.61.966.279.22.53.47.749.748C21 5.94 21 7.734 21 11.325v1.35c0 3.59 0 5.386-.966 6.61-.22.279-.47.53-.748.749-1.226.966-3.02.966-6.611.966h-1.35c-3.59 0-5.385 0-6.61-.966a4.497 4.497 0 0 1-.749-.748C3 18.06 3 16.266 3 12.675v-1.35ZM11.325 4.5H13.5v15h-2.175c-1.83 0-3.076-.002-4.021-.111-.914-.105-1.356-.293-1.661-.533a3.004 3.004 0 0 1-.499-.499c-.24-.305-.428-.747-.533-1.661-.109-.945-.111-2.19-.111-4.021v-1.35c0-1.83.002-3.076.11-4.021.106-.914.293-1.356.534-1.661a3 3 0 0 1 .499-.499c.305-.24.747-.428 1.661-.533.945-.109 2.19-.111 4.021-.111ZM15 19.486c.666-.014 1.22-.042 1.696-.097.914-.105 1.356-.293 1.661-.533.186-.146.353-.314.499-.499.24-.305.428-.747.533-1.661.109-.945.111-2.19.111-4.021v-1.657H15v8.468Zm4.494-9.968c-.01-.904-.037-1.619-.105-2.214-.105-.914-.293-1.356-.533-1.661a3.004 3.004 0 0 0-.499-.499c-.305-.24-.747-.428-1.661-.533A18.58 18.58 0 0 0 15 4.514v5.004h4.494Z"
                    fill="currentColor"
                  ></path>
                </svg>
              </div>
              <div class="text-xs text-center">Templates</div>
            </div>

            <!-- Uploads -->
            <div
              @click="activeTool = 'uploads'; $dispatch('change-tool', { type: 'uploads' }); window.dispatchEvent(new CustomEvent('tool-changed', { detail: { type: 'uploads' } }));"
              :class="activeTool === 'uploads' ? 'bg-gray-100' : ''"
              class="flex flex-col items-center py-3 px-2 cursor-pointer hover:bg-gray-50"
            >
              <div class="mb-1">
                <svg
                  class="w-[21px] h-[21px] text-gray-800"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M11.24 2.985c-2.735 0-5.04 2.075-5.316 4.788a.199.199 0 0 1-.123.162 5.729 5.729 0 0 0 1.994 11.097 5.727 5.727 0 0 0 5.727-5.727v-.486l1.782 1.782a.75.75 0 0 0 1.06-1.06l-3.062-3.063a.75.75 0 0 0-1.06 0L9.179 13.54a.75.75 0 0 0 1.06 1.06l1.783-1.781v.486A4.227 4.227 0 1 1 6.324 9.34a1.698 1.698 0 0 0 1.092-1.416c.198-1.943 1.855-3.44 3.825-3.44a3.848 3.848 0 0 1 3.785 3.174c.135.764.78 1.366 1.563 1.43 2.146.178 3.855 2.016 3.855 4.216a4.226 4.226 0 0 1-4.227 4.227h-1.914a.75.75 0 0 0 0 1.5h1.914a5.727 5.727 0 0 0 5.727-5.727c0-2.978-2.305-5.468-5.231-5.71a.25.25 0 0 1-.21-.196 5.348 5.348 0 0 0-5.262-4.414Z"
                    fill="currentColor"
                  ></path>
                </svg>
              </div>
              <div class="text-xs text-center">Uploads</div>
            </div>

            <!-- Text -->
            <div
              @click="activeTool = 'text'; $dispatch('change-tool', { type: 'text' }); window.dispatchEvent(new CustomEvent('tool-changed', { detail: { type: 'text' } }));"
              :class="activeTool === 'text' ? 'bg-gray-100' : ''"
              class="flex flex-col items-center py-3 px-2 cursor-pointer hover:bg-gray-50"
            >
              <div class="mb-1">
                <svg
                  class="w-[18px] h-[18px] text-gray-800"
                  viewBox="0 0 189.127 189.127"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M177.688,0H11.438c-4.143,0-7.5,3.358-7.5,7.5v46.23c0,4.142,3.357,7.5,7.5,7.5s7.5-3.358,7.5-7.5V15 h68.125v159.127H62.688c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h63.75c4.143,0,7.5-3.358,7.5-7.5s-3.357-7.5-7.5-7.5h-24.375 V15h68.125v38.73c0,4.142,3.357,7.5,7.5,7.5s7.5-3.358,7.5-7.5V7.5C185.188,3.358,181.831,0,177.688,0z"
                    fill="currentColor"
                  ></path>
                </svg>
              </div>
              <div class="text-xs text-center">Text</div>
            </div>

            <!-- Drawing -->
            <div
              @click="activeTool = 'drawing'; $dispatch('change-tool', { type: 'drawing' }); window.dispatchEvent(new CustomEvent('tool-changed', { detail: { type: 'drawing' } }));"
              :class="activeTool === 'drawing' ? 'bg-gray-100' : ''"
              class="flex flex-col items-center py-3 px-2 cursor-pointer hover:bg-gray-50"
            >
              <div class="mb-1">
                <svg
                  class="w-[21px] h-[21px] text-gray-800"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    fill-rule="evenodd"
                    clip-rule="evenodd"
                    d="M20.07 3.456a3.135 3.135 0 0 0-4.434 0L10.25 8.843a3.38 3.38 0 0 0-.884 1.55l-.845 3.292c-.205.8.522 1.527 1.322 1.323l3.278-.837a3.384 3.384 0 0 0 1.555-.886L20.07 7.89a3.135 3.135 0 0 0 0-4.434Zm-2.117 4.43 1.057-1.057a1.635 1.635 0 0 0-2.313-2.313l-1.056 1.057 2.312 2.312Zm-1.166 1.166-3.172 3.172c-.24.24-.539.41-.866.493l-2.602.665.67-2.616a1.88 1.88 0 0 1 .492-.862l3.165-3.164 2.313 2.312Z"
                    fill="currentColor"
                  ></path>
                  <path
                    d="M5.144 15.022a.641.641 0 1 0 0 1.282h13.751a2.109 2.109 0 0 1 0 4.218H9.194a.75.75 0 0 1 0-1.5h9.701a.609.609 0 1 0 0-1.218H5.144a2.141 2.141 0 0 1 0-4.282h1.862v1.5H5.144Z"
                    fill="currentColor"
                  ></path>
                </svg>
              </div>
              <div class="text-xs text-center">Drawing</div>
            </div>

            <!-- Settings -->
            <div
              @click="activeTool = 'settings'; $dispatch('change-tool', { type: 'settings' }); window.dispatchEvent(new CustomEvent('tool-changed', { detail: { type: 'settings' } }));"
              :class="activeTool === 'settings' ? 'bg-gray-100' : ''"
              class="flex flex-col items-center py-3 px-2 cursor-pointer hover:bg-gray-50"
            >
              <div class="mb-1">
                <svg
                  class="w-[21px] h-[21px] text-gray-800"
                  viewBox="0 0 32 32"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M29 11.756h-1.526c-0.109-0.295-0.229-0.584-0.361-0.87l1.087-1.076c0.441-0.389 0.717-0.956 0.717-1.587 0-0.545-0.206-1.042-0.545-1.417l0.002 0.002-3.178-3.178c-0.373-0.338-0.87-0.544-1.415-0.544-0.632 0-1.199 0.278-1.587 0.718l-0.002 0.002-1.081 1.080c-0.285-0.131-0.573-0.251-0.868-0.36l0.008-1.526c0.003-0.042 0.005-0.091 0.005-0.141 0-1.128-0.884-2.049-1.997-2.109l-0.005-0h-4.496c-1.119 0.059-2.004 0.981-2.004 2.11 0 0.049 0.002 0.098 0.005 0.147l-0-0.007v1.524c-0.295 0.109-0.584 0.229-0.87 0.361l-1.074-1.084c-0.389-0.443-0.957-0.722-1.589-0.722-0.545 0-1.042 0.206-1.416 0.545l0.002-0.002-3.179 3.179c-0.338 0.373-0.544 0.87-0.544 1.415 0 0.633 0.278 1.2 0.719 1.587l0.002 0.002 1.078 1.079c-0.132 0.287-0.252 0.576-0.362 0.872l-1.525-0.007c-0.042-0.003-0.091-0.005-0.14-0.005-1.128 0-2.050 0.885-2.11 1.998l-0 0.005v4.495c0.059 1.119 0.982 2.005 2.111 2.005 0.049 0 0.098-0.002 0.146-0.005l-0.007 0h1.525c0.109 0.295 0.229 0.584 0.361 0.87l-1.084 1.071c-0.443 0.39-0.721 0.958-0.721 1.592 0 0.545 0.206 1.043 0.545 1.418l-0.002-0.002 3.179 3.178c0.339 0.337 0.806 0.545 1.322 0.545 0.007 0 0.014-0 0.021-0h-0.001c0.653-0.013 1.24-0.287 1.662-0.722l0.001-0.001 1.079-1.079c0.287 0.132 0.577 0.252 0.873 0.362l-0.007 1.524c-0.003 0.042-0.005 0.091-0.005 0.14 0 1.128 0.885 2.050 1.998 2.11l0.005 0h4.496c1.118-0.060 2.003-0.981 2.003-2.109 0-0.050-0.002-0.099-0.005-0.147l0 0.007v-1.526c0.296-0.11 0.585-0.23 0.872-0.362l1.069 1.079c0.423 0.435 1.009 0.709 1.66 0.723l0.002 0h0.002c0.006 0 0.014 0 0.021 0 0.515 0 0.982-0.207 1.323-0.541l3.177-3.177c0.335-0.339 0.541-0.805 0.541-1.32 0-0.009-0-0.018-0-0.028l0 0.001c-0.013-0.651-0.285-1.236-0.718-1.658l-0.001-0-1.080-1.081c0.131-0.285 0.251-0.573 0.36-0.868l1.525 0.007c0.042 0.003 0.090 0.005 0.139 0.005 1.129 0 2.051-0.885 2.11-1.999l0-0.005v-4.495c-0.060-1.119-0.981-2.004-2.11-2.004-0.049 0-0.098 0.002-0.147 0.005l0.007-0zM28.75 17.749l-2.162-0.011c-0.026 0-0.048 0.013-0.074 0.015-0.093 0.009-0.179 0.026-0.261 0.053l0.008-0.002c-0.31 0.068-0.565 0.263-0.711 0.527l-0.003 0.005c-0.048 0.071-0.091 0.152-0.124 0.238l-0.003 0.008c-0.008 0.024-0.027 0.041-0.034 0.066-0.23 0.804-0.527 1.503-0.898 2.155l0.025-0.048c-0.014 0.025-0.013 0.054-0.026 0.080-0.029 0.063-0.053 0.138-0.071 0.215l-0.001 0.008c-0.023 0.072-0.040 0.156-0.048 0.242l-0 0.005c-0.002 0.027-0.004 0.058-0.004 0.089 0 0.209 0.061 0.404 0.166 0.568l-0.003-0.004c0.045 0.088 0.096 0.163 0.154 0.232l-0.001-0.002c0.017 0.019 0.022 0.043 0.040 0.061l1.529 1.531-2.469 2.467-1.516-1.529c-0.020-0.021-0.048-0.027-0.069-0.046-0.060-0.050-0.128-0.096-0.2-0.135l-0.006-0.003c-0.195-0.109-0.429-0.173-0.677-0.173-0.002 0-0.004 0-0.006 0h0c-0.076 0.008-0.145 0.022-0.211 0.040l0.009-0.002c-0.102 0.020-0.192 0.050-0.276 0.089l0.007-0.003c-0.022 0.011-0.047 0.010-0.069 0.022-0.606 0.346-1.307 0.644-2.043 0.859l-0.070 0.017c-0.027 0.008-0.045 0.027-0.071 0.037-0.084 0.033-0.157 0.071-0.224 0.116l0.004-0.003c-0.075 0.041-0.139 0.085-0.199 0.135l0.002-0.002c-0.053 0.052-0.102 0.11-0.145 0.171l-0.003 0.004c-0.103 0.113-0.176 0.254-0.206 0.411l-0.001 0.005c-0.024 0.074-0.043 0.16-0.051 0.249l-0 0.005c-0.002 0.026-0.015 0.048-0.015 0.075l-0.001 2.162h-3.491l0.011-2.156c0-0.028-0.014-0.052-0.016-0.079-0.008-0.092-0.026-0.177-0.052-0.258l0.002 0.008c-0.068-0.313-0.265-0.57-0.531-0.717l-0.006-0.003c-0.070-0.047-0.15-0.089-0.235-0.122l-0.008-0.003c-0.024-0.008-0.042-0.027-0.067-0.034-0.806-0.23-1.507-0.528-2.161-0.9l0.048 0.025c-0.023-0.013-0.050-0.012-0.073-0.023-0.072-0.033-0.156-0.061-0.244-0.079l-0.008-0.001c-0.092-0.029-0.198-0.045-0.308-0.045-0.221 0-0.426 0.066-0.597 0.18l0.004-0.002c-0.076 0.040-0.141 0.084-0.201 0.134l0.002-0.002c-0.021 0.019-0.048 0.025-0.068 0.045l-1.529 1.529-2.47-2.469 1.532-1.516c0.020-0.020 0.027-0.047 0.045-0.067 0.053-0.063 0.101-0.134 0.142-0.209l0.003-0.006c0.037-0.058 0.071-0.124 0.099-0.194l0.003-0.008c0.038-0.14 0.062-0.301 0.066-0.467l0-0.003c-0.008-0.083-0.023-0.158-0.044-0.231l0.002 0.009c-0.020-0.094-0.047-0.177-0.083-0.255l0.003 0.007c-0.012-0.025-0.011-0.052-0.025-0.076-0.347-0.605-0.645-1.305-0.858-2.041l-0.017-0.068c-0.007-0.026-0.027-0.045-0.036-0.070-0.034-0.086-0.072-0.16-0.118-0.228l0.003 0.005c-0.040-0.074-0.084-0.138-0.133-0.197l0.002 0.002c-0.052-0.053-0.109-0.101-0.169-0.144l-0.004-0.003c-0.060-0.051-0.128-0.097-0.2-0.136l-0.006-0.003c-0.057-0.026-0.126-0.049-0.196-0.066l-0.008-0.002c-0.077-0.026-0.167-0.045-0.259-0.053l-0.005-0c-0.026-0.002-0.047-0.015-0.073-0.015l-2.162-0.001v-3.492l2.162 0.011c0.16-0.002 0.311-0.035 0.45-0.092l-0.008 0.003c0.054-0.024 0.099-0.048 0.142-0.075l-0.005 0.003c0.090-0.047 0.168-0.1 0.239-0.16l-0.002 0.001c0.043-0.039 0.082-0.079 0.118-0.122l0.002-0.002c0.056-0.065 0.106-0.138 0.147-0.215l0.003-0.007c0.027-0.047 0.054-0.102 0.076-0.159l0.003-0.008c0.010-0.028 0.029-0.050 0.037-0.078 0.23-0.805 0.527-1.506 0.899-2.159l-0.025 0.048c0.014-0.024 0.013-0.052 0.025-0.076 0.031-0.067 0.057-0.147 0.075-0.229l0.001-0.008c0.020-0.086 0.032-0.185 0.032-0.287 0-0.317-0.113-0.607-0.3-0.834l0.002 0.002c-0.017-0.020-0.023-0.045-0.042-0.063l-1.527-1.529 2.469-2.469 1.518 1.531c0.055 0.045 0.116 0.087 0.18 0.122l0.006 0.003c0.042 0.033 0.089 0.065 0.138 0.094l0.006 0.003c0.16 0.088 0.35 0.142 0.551 0.148l0.002 0 0.005 0.001c0.012 0 0.023-0.009 0.034-0.009 0.186-0.008 0.359-0.056 0.513-0.135l-0.007 0.003c0.022-0.011 0.047-0.006 0.070-0.018 0.605-0.346 1.305-0.645 2.041-0.858l0.069-0.017c0.025-0.007 0.042-0.026 0.066-0.034 0.091-0.035 0.17-0.076 0.243-0.125l-0.004 0.003c0.069-0.038 0.128-0.079 0.183-0.124l-0.002 0.002c0.058-0.056 0.11-0.117 0.156-0.183l0.003-0.004c0.046-0.056 0.089-0.119 0.126-0.185l0.003-0.006c0.028-0.062 0.053-0.135 0.070-0.21l0.002-0.008c0.024-0.073 0.042-0.158 0.050-0.247l0-0.005c0.002-0.027 0.015-0.049 0.015-0.076l0.001-2.162h3.491l-0.011 2.156c-0 0.028 0.014 0.051 0.015 0.079 0.008 0.093 0.026 0.178 0.052 0.26l-0.002-0.008c0.019 0.084 0.044 0.157 0.075 0.227l-0.003-0.008c0.040 0.073 0.082 0.136 0.13 0.194l-0.002-0.002c0.048 0.070 0.101 0.131 0.158 0.187l0 0c0.053 0.044 0.112 0.084 0.174 0.12l0.006 0.003c0.068 0.046 0.147 0.087 0.23 0.119l0.008 0.003c0.025 0.009 0.043 0.028 0.069 0.035 0.804 0.229 1.503 0.527 2.155 0.899l-0.047-0.025c0.022 0.012 0.046 0.007 0.068 0.018 0.147 0.076 0.32 0.124 0.503 0.132l0.003 0c0.012 0 0.024 0.009 0.036 0.009l0.028-0.008c0.193-0.008 0.372-0.059 0.531-0.143l-0.007 0.003c0.059-0.033 0.109-0.066 0.156-0.104l-0.003 0.002c0.068-0.037 0.127-0.076 0.181-0.12l-0.002 0.002 1.531-1.528 2.469 2.47-1.531 1.516c-0.020 0.020-0.027 0.047-0.046 0.068-0.053 0.063-0.101 0.134-0.142 0.209l-0.003 0.006c-0.084 0.123-0.138 0.272-0.148 0.434l-0 0.002c-0.013 0.056-0.020 0.121-0.020 0.187 0 0.097 0.016 0.19 0.045 0.277l-0.002-0.006c0.020 0.094 0.047 0.176 0.083 0.254l-0.003-0.007c0.012 0.025 0.011 0.053 0.025 0.078 0.347 0.604 0.645 1.303 0.858 2.038l0.017 0.068c0.008 0.030 0.028 0.052 0.038 0.080 0.024 0.062 0.049 0.113 0.077 0.163l-0.003-0.006c0.211 0.397 0.619 0.665 1.090 0.674l0.001 0 2.162 0.001zM16 10.75c-2.899 0-5.25 2.351-5.25 5.25s2.351 5.25 5.25 5.25c2.899 0 5.25-2.351 5.25-5.25v0c-0.004-2.898-2.352-5.246-5.25-5.25h-0zM16 18.75c-1.519 0-2.75-1.231-2.75-2.75s1.231-2.75 2.75-2.75c1.519 0 2.75 1.231 2.75 2.75v0c-0.002 1.518-1.232 2.748-2.75 2.75h-0z"
                    fill="currentColor"
                  ></path>
                </svg>
              </div>
              <div class="text-xs text-center">Settings</div>
            </div>

            <!-- Categories Area -->
            <hr class="w-full my-2 border-gray-200" />

            <!-- Clip Arts -->
            <div
              @click="activeTool = 'clip_arts'; $dispatch('change-tool', { type: 'clip_arts' }); window.dispatchEvent(new CustomEvent('tool-changed', { detail: { type: 'clip_arts' } }));"
              :class="activeTool === 'clip_arts' ? 'bg-gray-100' : ''"
              class="flex flex-col items-center py-3 px-2 cursor-pointer hover:bg-gray-50"
            >
              <div class="mb-1">
                <img
                  src="./images/icons/clip-art.svg"
                  alt="Clip Art"
                  class="w-[21px] h-[21px]"
                />
              </div>
              <div class="text-xs text-center">Clip Arts</div>
            </div>
            <!-- Mask -->
            <div
              @click="activeTool = 'mask'; $dispatch('change-tool', { type: 'mask' }); window.dispatchEvent(new CustomEvent('tool-changed', { detail: { type: 'mask' } }));"
              :class="activeTool === 'mask' ? 'bg-gray-100' : ''"
              class="flex flex-col items-center py-3 px-2 cursor-pointer hover:bg-gray-50"
            >
              <div class="mb-1">
                <img
                  src="./images/icons/mask.svg"
                  alt="Mask"
                  class="w-[21px] h-[21px]"
                />
              </div>
              <div class="text-xs text-center">Mask</div>
            </div>
          </div>

          <!-- Bottom Items -->
          <div class="flex flex-col">
            <!-- Layers -->
            <div
              @click="activeTool = 'layers'; $dispatch('change-tool', { type: 'layers' }); window.dispatchEvent(new CustomEvent('tool-changed', { detail: { type: 'layers' } }));"
              :class="activeTool === 'layers' ? 'bg-gray-100' : ''"
              class="flex flex-col items-center py-3 px-2 cursor-pointer hover:bg-gray-50"
            >
              <div class="mb-1">
                <svg
                  class="w-[21px] h-[21px] text-gray-800"
                  viewBox="0 0 24 24"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="m19.474 12.838 1.697.835a1 1 0 0 1 0 1.795L13.32 19.33a3 3 0 0 1-2.649 0L2.82 15.468a1 1 0 0 1 0-1.795l1.697-.835 1.698.836-1.821.896 6.94 3.415a1.5 1.5 0 0 0 1.324 0l6.94-3.415-1.822-.896 1.7-.836ZM13.32 4.673l7.852 3.864a1 1 0 0 1 0 1.794l-7.852 3.864a3 3 0 0 1-2.649 0L2.82 10.33a1 1 0 0 1 0-1.794l7.851-3.864a3 3 0 0 1 2.65 0Zm-1.986 8.176a1.5 1.5 0 0 0 1.324 0l6.94-3.415-6.94-3.415a1.5 1.5 0 0 0-1.324 0l-6.94 3.415 6.94 3.415Z"
                    fill="currentColor"
                  ></path>
                </svg>
              </div>
              <div class="text-xs text-center">Layers</div>
            </div>
          </div>
        </div>
        <!-- Panels -->
        <div
          class="min-w-[335px] max-w-[335px] h-full overflow-hidden relative py-2.5 px-0 rounded-[10px] block"
        >
          <!-- Templates -->
          <div
            x-data="{ isActive: true }"
            x-show="isActive"
            @tool-changed.window="isActive = $event.detail.type === 'templates'"
            class="h-full flex flex-col"
          >
            <div class="p-4 border-b border-gray-200">
              <h3 class="text-lg font-medium text-gray-800">Templates</h3>
            </div>

            <div class="flex-1 overflow-y-auto p-4">
              <div class="text-center text-gray-700">No templates found!</div>
            </div>
          </div>
          <!-- UploadsPanel -->
          <div
            x-data="uploadsPanel"
            x-show="isActive"
            @tool-changed.window="isActive = $event.detail.type === 'uploads'"
            class="h-full flex flex-col"
          >
            <!-- Panel Header -->
            <div class="p-4 border-b border-gray-200">
              <h3 class="text-lg font-medium text-gray-800">Uploads</h3>
            </div>

            <!-- Body -->
            <div class="flex-1 overflow-y-auto p-4 flex flex-col gap-4">
              <!-- Upload Btn -->
              <label
                class="flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded cursor-pointer transition"
              >
                <svg
                  class="w-[17px] h-[17px] text-gray-700"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 -960 960 960"
                >
                  <path
                    fill="currentColor"
                    d="M444-192v-438L243-429l-51-51 288-288 288 288-51 51-201-201v438h-72Z"
                  />
                </svg>
                <span>Upload File</span>
                <input
                  type="file"
                  class="hidden"
                  id="upload-file-inp"
                  multiple
                  @change="handleFileUpload"
                />
              </label>

              <!-- Media Component -->
              <div class="flex-1 overflow-y-auto">
                <div
                  class="grid grid-cols-2 md:grid-cols-3 gap-2"
                  id="file-upload-con"
                  x-show="uploads.length > 0"
                ></div>
                <div
                  class="text-center text-gray-700 py-4"
                  x-show="uploads.length === 0"
                >
                  No uploads found!
                </div>
              </div>

              <!-- Image Tools -->
              <div
                x-show="selectedObject && selectedObject.type === 'image'"
                class="space-y-4"
              >
                <!-- Filters -->
                <div class="space-y-2">
                  <div class="flex justify-between items-center">
                    <span class="font-medium text-sm">Filters:</span>
                    <button
                      @click="resetFilters"
                      class="text-gray-700 hover:text-gray-900 p-1 rounded-full hover:bg-gray-100 transition"
                    >
                      <svg
                        class="w-[17px] h-[17px]"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 -960 960 960"
                      >
                        <path
                          fill="currentColor"
                          d="M440-122q-121-15-200.5-105.5T160-440q0-66 26-126.5T260-672l57 57q-38 34-57.5 79T240-440q0 88 56 155.5T440-202v80Zm80 0v-80q87-16 143.5-83T720-440q0-100-70-170t-170-70h-3l44 44-56 56-140-140 140-140 56 56-44 44h3q134 0 227 93t93 227q0 121-79.5 211.5T520-122Z"
                        ></path>
                      </svg>
                    </button>
                  </div>

                  <!-- Filter Previews - Horizontal Scroll -->
                  <div
                    class="flex overflow-x-auto pb-2 space-x-3 scrollbar-thin scrollbar-thumb-gray-300"
                  >
                    <!-- Black White -->
                    <div
                      @click="applyPresetFilter('black_white')"
                      :class="activeFilter === 'black_white' ? 'ring-2 ring-blue-500' : ''"
                      class="flex flex-col items-center min-w-[80px] cursor-pointer"
                    >
                      <div class="w-16 h-16 overflow-hidden rounded mb-1">
                        <img
                          src="./images/filters/black_white.png"
                          alt="Black White filter"
                          class="w-full h-full object-cover"
                        />
                      </div>
                      <span class="text-xs">Black White</span>
                    </div>

                    <!-- Brownie -->
                    <div
                      @click="applyPresetFilter('brownie')"
                      :class="activeFilter === 'brownie' ? 'ring-2 ring-blue-500' : ''"
                      class="flex flex-col items-center min-w-[80px] cursor-pointer"
                    >
                      <div class="w-16 h-16 overflow-hidden rounded mb-1">
                        <img
                          src="./images/filters/brownie.png"
                          alt="Brownie filter"
                          class="w-full h-full object-cover"
                        />
                      </div>
                      <span class="text-xs">Brownie</span>
                    </div>

                    <!-- Grayscale -->
                    <div
                      @click="applyPresetFilter('grayscale')"
                      :class="activeFilter === 'grayscale' ? 'ring-2 ring-blue-500' : ''"
                      class="flex flex-col items-center min-w-[80px] cursor-pointer"
                    >
                      <div class="w-16 h-16 overflow-hidden rounded mb-1">
                        <img
                          src="./images/filters/grayscale.png"
                          alt="Grayscale filter"
                          class="w-full h-full object-cover"
                        />
                      </div>
                      <span class="text-xs">Grayscale</span>
                    </div>

                    <!-- Invert -->
                    <div
                      @click="applyPresetFilter('invert')"
                      :class="activeFilter === 'invert' ? 'ring-2 ring-blue-500' : ''"
                      class="flex flex-col items-center min-w-[80px] cursor-pointer"
                    >
                      <div class="w-16 h-16 overflow-hidden rounded mb-1">
                        <img
                          src="./images/filters/invert.png"
                          alt="Invert filter"
                          class="w-full h-full object-cover"
                        />
                      </div>
                      <span class="text-xs">Invert</span>
                    </div>

                    <!-- Sepia -->
                    <div
                      @click="applyPresetFilter('sepia')"
                      :class="activeFilter === 'sepia' ? 'ring-2 ring-blue-500' : ''"
                      class="flex flex-col items-center min-w-[80px] cursor-pointer"
                    >
                      <div class="w-16 h-16 overflow-hidden rounded mb-1">
                        <img
                          src="./images/filters/sepia.png"
                          alt="Sepia filter"
                          class="w-full h-full object-cover"
                        />
                      </div>
                      <span class="text-xs">Sepia</span>
                    </div>

                    <!-- Kodachrome -->
                    <div
                      @click="applyPresetFilter('kodachrome')"
                      :class="activeFilter === 'kodachrome' ? 'ring-2 ring-blue-500' : ''"
                      class="flex flex-col items-center min-w-[80px] cursor-pointer"
                    >
                      <div class="w-16 h-16 overflow-hidden rounded mb-1">
                        <img
                          src="./images/filters/kodachrome.png"
                          alt="Kodachrome filter"
                          class="w-full h-full object-cover"
                        />
                      </div>
                      <span class="text-xs">Kodachrome</span>
                    </div>

                    <!-- Technicolor -->
                    <div
                      @click="applyPresetFilter('technicolor')"
                      :class="activeFilter === 'technicolor' ? 'ring-2 ring-blue-500' : ''"
                      class="flex flex-col items-center min-w-[80px] cursor-pointer"
                    >
                      <div class="w-16 h-16 overflow-hidden rounded mb-1">
                        <img
                          src="./images/filters/technicolor.png"
                          alt="Technicolor filter"
                          class="w-full h-full object-cover"
                        />
                      </div>
                      <span class="text-xs">Technicolor</span>
                    </div>

                    <!-- Sharpen -->
                    <div
                      @click="applyPresetFilter('sharpen')"
                      :class="activeFilter === 'sharpen' ? 'ring-2 ring-blue-500' : ''"
                      class="flex flex-col items-center min-w-[80px] cursor-pointer"
                    >
                      <div class="w-16 h-16 overflow-hidden rounded mb-1">
                        <img
                          src="./images/filters/sharpen.png"
                          alt="Sharpen filter"
                          class="w-full h-full object-cover"
                        />
                      </div>
                      <span class="text-xs">Sharpen</span>
                    </div>

                    <!-- Polaroid -->
                    <div
                      @click="applyPresetFilter('polaroid')"
                      :class="activeFilter === 'polaroid' ? 'ring-2 ring-blue-500' : ''"
                      class="flex flex-col items-center min-w-[80px] cursor-pointer"
                    >
                      <div class="w-16 h-16 overflow-hidden rounded mb-1">
                        <img
                          src="./images/filters/polaroid.png"
                          alt="Polaroid filter"
                          class="w-full h-full object-cover"
                        />
                      </div>
                      <span class="text-xs">Polaroid</span>
                    </div>

                    <!-- Emboss -->
                    <div
                      @click="applyPresetFilter('emboss')"
                      :class="activeFilter === 'emboss' ? 'ring-2 ring-blue-500' : ''"
                      class="flex flex-col items-center min-w-[80px] cursor-pointer"
                    >
                      <div class="w-16 h-16 overflow-hidden rounded mb-1">
                        <img
                          src="./images/filters/emboss.png"
                          alt="Emboss filter"
                          class="w-full h-full object-cover"
                        />
                      </div>
                      <span class="text-xs">Emboss</span>
                    </div>

                    <!-- Vintage -->
                    <div
                      @click="applyPresetFilter('vintage')"
                      :class="activeFilter === 'vintage' ? 'ring-2 ring-blue-500' : ''"
                      class="flex flex-col items-center min-w-[80px] cursor-pointer"
                    >
                      <div class="w-16 h-16 overflow-hidden rounded mb-1">
                        <img
                          src="./images/filters/vintage.png"
                          alt="Vintage filter"
                          class="w-full h-full object-cover"
                        />
                      </div>
                      <span class="text-xs">Vintage</span>
                    </div>
                  </div>
                </div>

                <!-- Image Filters -->
                <div class="space-y-3">
                  <!-- Brightness -->
                  <div class="space-y-1">
                    <span class="text-sm font-medium">Brightness</span>
                    <input
                      type="range"
                      class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                      min="-1"
                      max="1"
                      step="0.003921"
                      x-model="filters.brightness"
                      @input="applyFilter('brightness', $event.target.value)"
                    />
                  </div>

                  <!-- Contrast -->
                  <div class="space-y-1">
                    <span class="text-sm font-medium">Contrast</span>
                    <input
                      type="range"
                      class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                      min="-1"
                      max="1"
                      step="0.003921"
                      x-model="filters.contrast"
                      @input="applyFilter('contrast', $event.target.value)"
                    />
                  </div>

                  <!-- Blur -->
                  <div class="space-y-1">
                    <span class="text-sm font-medium">Blur</span>
                    <input
                      type="range"
                      class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                      min="0"
                      max="1"
                      step="0.01"
                      x-model="filters.blur"
                      @input="applyFilter('blur', $event.target.value)"
                    />
                  </div>

                  <!-- Noise -->
                  <div class="space-y-1">
                    <span class="text-sm font-medium">Noise</span>
                    <input
                      type="range"
                      class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                      min="0"
                      max="1000"
                      step="1"
                      x-model="filters.noise"
                      @input="applyFilter('noise', $event.target.value)"
                    />
                  </div>

                  <!-- Saturation -->
                  <div class="space-y-1">
                    <span class="text-sm font-medium">Saturation</span>
                    <input
                      type="range"
                      class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                      min="-1"
                      max="1"
                      step="0.003921"
                      x-model="filters.saturation"
                      @input="applyFilter('saturation', $event.target.value)"
                    />
                  </div>

                  <!-- Hue -->
                  <div class="space-y-1">
                    <span class="text-sm font-medium">Hue</span>
                    <input
                      type="range"
                      class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                      min="-2"
                      max="2"
                      step="0.002"
                      x-model="filters.hue"
                      @input="applyFilter('hue', $event.target.value)"
                    />
                  </div>

                  <!-- Pixelate -->
                  <div class="space-y-1">
                    <span class="text-sm font-medium">Pixelate</span>
                    <input
                      type="range"
                      class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                      min="2"
                      max="20"
                      step="1"
                      x-model="filters.pixelate"
                      @input="applyFilter('pixelate', $event.target.value)"
                    />
                  </div>
                </div>

                <!-- Opacity -->
                <div class="space-y-1">
                  <div class="flex justify-between items-center">
                    <span class="text-sm font-medium">Opacity</span>
                    <input
                      type="number"
                      class="w-12 bg-gray-100 rounded text-center px-1 py-0.5 text-sm"
                      x-model="objectProperties.opacity"
                      readonly
                    />
                  </div>
                  <input
                    type="range"
                    class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                    min="0"
                    max="1"
                    step="0.1"
                    x-model="objectProperties.opacity"
                    @input="updateObjectProperty('opacity', $event.target.value)"
                  />
                </div>

                <!-- Outline -->
                <div class="space-y-1">
                  <div class="flex justify-between items-center">
                    <span class="text-sm font-medium">Outline</span>
                    <div class="flex items-center space-x-2">
                      <div
                        class="w-6 h-6 rounded border border-gray-300 overflow-hidden"
                      >
                        <input
                          type="color"
                          class="w-8 h-8 transform -translate-x-1 -translate-y-1"
                          x-model="objectProperties.stroke"
                          @input="updateObjectProperty('stroke', $event.target.value)"
                        />
                      </div>
                      <input
                        type="number"
                        class="w-12 bg-gray-100 rounded text-center px-1 py-0.5 text-sm"
                        x-model="objectProperties.strokeWidth"
                        readonly
                      />
                    </div>
                  </div>
                  <input
                    type="range"
                    class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                    min="0"
                    max="2"
                    step="0.1"
                    x-model="objectProperties.strokeWidth"
                    @input="updateObjectProperty('strokeWidth', $event.target.value)"
                  />
                </div>

                <!-- Radius -->
                <div class="space-y-1">
                  <div class="flex justify-between items-center">
                    <span class="text-sm font-medium">Radius</span>
                    <input
                      type="number"
                      class="w-12 bg-gray-100 rounded text-center px-1 py-0.5 text-sm"
                      x-model="objectProperties.radius"
                      readonly
                    />
                  </div>
                  <input
                    type="range"
                    class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                    min="0"
                    max="100"
                    step="1"
                    x-model="objectProperties.radius"
                    @input="updateClipPath($event.target.value)"
                  />
                </div>

                <!-- Distortion -->
                <div class="border border-gray-200 rounded overflow-hidden">
                  <div
                    @click="showDistortion = !showDistortion"
                    class="flex justify-between items-center p-3 cursor-pointer hover:bg-gray-50"
                  >
                    <div class="flex items-center">
                      <svg
                        class="w-4 h-4 mr-2 transition-transform duration-200"
                        :class="showDistortion ? 'rotate-90' : ''"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 -960 960 960"
                      >
                        <path
                          fill="currentColor"
                          d="M504-480 320-664l56-56 240 240-240 240-56-56 184-184Z"
                        />
                      </svg>
                      <span class="text-sm font-medium">Distortion</span>
                    </div>
                  </div>

                  <div
                    x-show="showDistortion"
                    x-transition
                    class="p-3 border-t border-gray-200 space-y-3"
                  >
                    <!-- SkewX -->
                    <div class="space-y-1">
                      <div class="flex justify-between items-center">
                        <span class="text-sm font-medium">SkewX</span>
                        <input
                          type="text"
                          class="w-12 bg-gray-100 rounded text-center px-1 py-0.5 text-sm"
                          x-model="objectProperties.skewX"
                        />
                      </div>
                      <input
                        type="range"
                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="0"
                        max="180"
                        x-model="objectProperties.skewX"
                        @input="updateObjectProperty('skewX', $event.target.value)"
                      />
                    </div>

                    <!-- SkewY -->
                    <div class="space-y-1">
                      <div class="flex justify-between items-center">
                        <span class="text-sm font-medium">SkewY</span>
                        <input
                          type="text"
                          class="w-12 bg-gray-100 rounded text-center px-1 py-0.5 text-sm"
                          x-model="objectProperties.skewY"
                        />
                      </div>
                      <input
                        type="range"
                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="0"
                        max="180"
                        x-model="objectProperties.skewY"
                        @input="updateObjectProperty('skewY', $event.target.value)"
                      />
                    </div>
                  </div>
                </div>

                <!-- Shadow -->
                <div class="border border-gray-200 rounded overflow-hidden">
                  <div
                    @click="showShadow = !showShadow"
                    class="flex justify-between items-center p-3 cursor-pointer hover:bg-gray-50"
                  >
                    <div class="flex items-center">
                      <svg
                        class="w-4 h-4 mr-2 transition-transform duration-200"
                        :class="showShadow ? 'rotate-90' : ''"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 -960 960 960"
                      >
                        <path
                          fill="currentColor"
                          d="M504-480 320-664l56-56 240 240-240 240-56-56 184-184Z"
                        />
                      </svg>
                      <span class="text-sm font-medium">Shadow</span>
                    </div>
                    <div
                      class="relative inline-block w-10 align-middle select-none"
                    >
                      <input
                        type="checkbox"
                        id="shadow-toggle"
                        name="shadow-toggle"
                        class="sr-only peer"
                        x-model="objectProperties.shadowEnabled"
                        @change="toggleShadow"
                      />
                      <label
                        for="shadow-toggle"
                        class="block h-6 overflow-hidden bg-gray-300 rounded-full cursor-pointer peer-checked:bg-blue-500 peer-checked:after:translate-x-4 after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all"
                      >
                      </label>
                    </div>
                  </div>

                  <div
                    x-show="showShadow && objectProperties.shadowEnabled"
                    x-transition
                    class="p-3 border-t border-gray-200 space-y-3"
                  >
                    <!-- Shadow Color -->
                    <div class="space-y-1">
                      <span class="text-sm font-medium">Color</span>
                      <div
                        class="w-full h-8 rounded border border-gray-300 overflow-hidden"
                      >
                        <input
                          type="color"
                          class="w-full h-10 transform -translate-y-1"
                          x-model="objectProperties.shadowColor"
                          @input="updateShadow('color', $event.target.value)"
                        />
                      </div>
                    </div>

                    <!-- Shadow Blur -->
                    <div class="space-y-1">
                      <div class="flex justify-between items-center">
                        <span class="text-sm font-medium">Blur</span>
                        <input
                          type="number"
                          class="w-12 bg-gray-100 rounded text-center px-1 py-0.5 text-sm"
                          x-model="objectProperties.shadowBlur"
                          readonly
                        />
                      </div>
                      <input
                        type="range"
                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="0"
                        max="50"
                        x-model="objectProperties.shadowBlur"
                        @input="updateShadow('blur', $event.target.value)"
                      />
                    </div>

                    <!-- Shadow OffsetX -->
                    <div class="space-y-1">
                      <div class="flex justify-between items-center">
                        <span class="text-sm font-medium">OffsetX</span>
                        <input
                          type="number"
                          class="w-12 bg-gray-100 rounded text-center px-1 py-0.5 text-sm"
                          x-model="objectProperties.shadowOffsetX"
                          readonly
                        />
                      </div>
                      <input
                        type="range"
                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="-100"
                        max="100"
                        x-model="objectProperties.shadowOffsetX"
                        @input="updateShadow('offsetX', $event.target.value)"
                      />
                    </div>

                    <!-- Shadow OffsetY -->
                    <div class="space-y-1">
                      <div class="flex justify-between items-center">
                        <span class="text-sm font-medium">OffsetY</span>
                        <input
                          type="number"
                          class="w-12 bg-gray-100 rounded text-center px-1 py-0.5 text-sm"
                          x-model="objectProperties.shadowOffsetY"
                          readonly
                        />
                      </div>
                      <input
                        type="range"
                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="-100"
                        max="100"
                        x-model="objectProperties.shadowOffsetY"
                        @input="updateShadow('offsetY', $event.target.value)"
                      />
                    </div>
                  </div>
                </div>
              </div>

              <!-- Shape Tools -->
              <div
                x-show="selectedObject && selectedObject.type === 'shape'"
                class="space-y-4"
              >
                <!-- Color Picker -->
                <div
                  class="w-full h-10 rounded border border-gray-300 overflow-hidden"
                >
                  <input
                    type="color"
                    class="w-full h-12 transform -translate-y-1"
                    x-model="objectProperties.fill"
                    @input="updateObjectProperty('fill', $event.target.value)"
                  />
                </div>

                <!-- Opacity -->
                <div class="space-y-1">
                  <div class="flex justify-between items-center">
                    <span class="text-sm font-medium">Opacity</span>
                    <input
                      type="number"
                      class="w-12 bg-gray-100 rounded text-center px-1 py-0.5 text-sm"
                      x-model="objectProperties.opacity"
                      readonly
                    />
                  </div>
                  <input
                    type="range"
                    class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                    min="0"
                    max="1"
                    step="0.1"
                    x-model="objectProperties.opacity"
                    @input="updateObjectProperty('opacity', $event.target.value)"
                  />
                </div>

                <!-- Rest of shape tools follow the same pattern as image tools -->
                <!-- I've abbreviated this section for brevity, but you would include the same controls -->
              </div>
            </div>
          </div>
          <!-- Text Panel -->
          <div
            x-data="textPanel"
            x-show="isActive"
            @tool-changed.window="isActive = $event.detail.type === 'text'"
            class="h-full flex flex-col"
          >
            <!-- Panel Header -->
            <div class="p-4 border-b border-gray-200">
              <h3 class="text-lg font-medium text-gray-800">Text</h3>
            </div>

            <div x-show="selectedObject && selectedObject.type === 'text'">
              <input
                type="text"
                x-model="selectedObject.text"
                @input="selectedObject.set('text', $event.target.value); window.canvas.renderAll()"
                class="w-full p-2 border rounded"
              />
            </div>

            <!-- Panel Body -->
            <div class="flex-1 overflow-y-auto p-4 flex flex-col gap-4">
              <!-- Add Text Button -->
              <button
                @click="addText()"
                class="flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded cursor-pointer transition"
              >
                <svg
                  class="w-[17px] h-[17px] text-gray-700"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 448 512"
                >
                  <path
                    fill="currentColor"
                    d="M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"
                  />
                </svg>
                <span>Add Text</span>
              </button>

              <!-- Pre-Built Headings -->
              <div class="flex flex-col gap-2">
                <div
                  @click="addHeading('full')"
                  class="p-3 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition text-lg font-semibold"
                >
                  Add a heading
                </div>
                <div
                  @click="addHeading('sub')"
                  class="p-3 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition text-base font-medium"
                >
                  Add a subheading
                </div>
                <div
                  @click="addHeading('paragraph')"
                  class="p-3 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition text-sm"
                >
                  Add a little bit of body text
                </div>
              </div>

              <!-- Text Tools -->
              <div
                x-show="selectedObject && (selectedObject.type === 'text' || selectedObject.type === 'curved-text')"
                class="space-y-4"
              >
                <!-- Text Modify Buttons -->
                <div class="flex items-center gap-2">
                  <!-- Color Picker -->
                  <div
                    class="w-10 h-10 rounded border border-gray-300 overflow-hidden"
                  >
                    <input
                      type="color"
                      class="w-12 h-12 transform -translate-x-1 -translate-y-1"
                      x-model="textProperties.fill"
                      @input="updateObjectProperty('fill', $event.target.value)"
                    />
                  </div>

                  <!-- Bold/Normal -->
                  <button
                    @click="toggleFontWeight()"
                    :class="textProperties.fontWeight === 'bold' ? 'bg-gray-200' : 'bg-gray-100'"
                    class="w-10 h-10 flex items-center justify-center rounded hover:bg-gray-200 transition"
                  >
                    <svg
                      class="w-[17px] h-[17px] text-gray-700"
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 -960 960 960"
                    >
                      <path
                        fill="currentColor"
                        d="M272-200v-560h221q65 0 120 40t55 111q0 51-23 78.5T602-491q25 11 55.5 41t30.5 90q0 89-65 124.5T501-200H272Zm121-112h104q48 0 58.5-24.5T566-372q0-11-10.5-35.5T494-432H393v120Zm0-228h93q33 0 48-17t15-38q0-24-17-39t-44-15h-95v109Z"
                      />
                    </svg>
                  </button>

                  <!-- Italic/Normal -->
                  <button
                    @click="toggleFontStyle()"
                    :class="textProperties.fontStyle === 'italic' ? 'bg-gray-200' : 'bg-gray-100'"
                    class="w-10 h-10 flex items-center justify-center rounded hover:bg-gray-200 transition"
                  >
                    <svg
                      class="w-[17px] h-[17px] text-gray-700"
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 -960 960 960"
                    >
                      <path
                        fill="currentColor"
                        d="M200-200v-100h160l120-360H320v-100h400v100H580L460-300h140v100H200Z"
                      />
                    </svg>
                  </button>

                  <!-- Underline/Normal -->
                  <button
                    @click="toggleUnderline()"
                    :class="textProperties.underline ? 'bg-gray-200' : 'bg-gray-100'"
                    class="w-10 h-10 flex items-center justify-center rounded hover:bg-gray-200 transition"
                  >
                    <svg
                      class="w-[17px] h-[17px] text-gray-700"
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 -960 960 960"
                    >
                      <path
                        fill="currentColor"
                        d="M200-120v-80h560v80H200Zm280-160q-101 0-157-63t-56-167v-330h103v336q0 56 28 91t82 35q54 0 82-35t28-91v-336h103v330q0 104-56 167t-157 63Z"
                      />
                    </svg>
                  </button>
                </div>

                <!-- Rotation -->
                <div class="space-y-1">
                  <div class="flex justify-between items-center">
                    <span class="text-sm font-medium">Rotation</span>
                    <input
                      type="number"
                      class="w-16 bg-gray-100 rounded text-center px-2 py-1 text-sm"
                      x-model="textProperties.rotation"
                      @input="updateTextRotation()"
                    />
                  </div>
                  <input
                    type="range"
                    class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                    min="0"
                    max="360"
                    x-model="textProperties.rotation"
                    @input="updateTextRotation()"
                  />
                </div>

                <!-- Font Family & Font Size -->
                <div class="space-y-1">
                  <span class="text-sm font-medium">Font Family</span>

                  <div class="flex items-center gap-2">
                    <!-- Font Family Dropdown -->
                    <div
                      x-data="{ open: false, search: '', filteredFonts: [] }"
                      class="relative w-full"
                    >
                      <div
                        @click="open = !open"
                        class="flex items-center justify-between p-2 bg-gray-100 rounded cursor-pointer"
                      >
                        <span x-text="textProperties.fontFamily">Roboto</span>
                        <svg
                          class="w-4 h-4 transition-transform"
                          :class="open ? 'rotate-180' : ''"
                          xmlns="http://www.w3.org/2000/svg"
                          viewBox="0 -960 960 960"
                        >
                          <path
                            fill="currentColor"
                            d="M480-333 240-573l51-51 189 189 189-189 51 51-240 240Z"
                          />
                        </svg>
                      </div>

                      <div
                        x-show="open"
                        @click.away="open = false"
                        x-transition
                        class="absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded shadow-lg"
                      >
                        <!-- Search Bar -->
                        <div class="p-2 border-b border-gray-200">
                          <input
                            type="text"
                            x-model="search"
                            @input="filterFonts()"
                            placeholder="Search fonts..."
                            class="w-full p-2 border border-gray-300 rounded"
                          />
                        </div>

                        <!-- Font List -->
                        <div class="max-h-60 overflow-y-auto p-1">
                          <template
                            x-for="font in search ? filteredFonts : fonts"
                            :key="font"
                          >
                            <div
                              @click="selectFont(font); open = false"
                              class="p-2 hover:bg-gray-100 rounded cursor-pointer"
                              :style="`font-family: ${font}`"
                              x-text="font"
                            ></div>
                          </template>
                        </div>
                      </div>
                    </div>

                    <!-- Font Size -->
                    <input
                      type="number"
                      class="w-16 bg-gray-100 rounded text-center px-2 py-1 text-sm"
                      x-model="textProperties.fontSize"
                      @input="updateObjectProperty('fontSize', $event.target.value)"
                      min="2"
                    />
                  </div>
                </div>

                <!-- Opacity -->
                <div class="space-y-1">
                  <div class="flex justify-between items-center">
                    <span class="text-sm font-medium">Opacity</span>
                    <input
                      type="number"
                      class="w-12 bg-gray-100 rounded text-center px-1 py-0.5 text-sm"
                      x-model="textProperties.opacity"
                      readonly
                    />
                  </div>
                  <input
                    type="range"
                    class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                    min="0"
                    max="1"
                    step="0.1"
                    x-model="textProperties.opacity"
                    @input="updateObjectProperty('opacity', $event.target.value)"
                  />
                </div>

                <!-- Outline -->
                <div class="space-y-1">
                  <div class="flex justify-between items-center">
                    <span class="text-sm font-medium">Outline</span>
                    <div class="flex items-center space-x-2">
                      <div
                        class="w-6 h-6 rounded border border-gray-300 overflow-hidden"
                      >
                        <input
                          type="color"
                          class="w-8 h-8 transform -translate-x-1 -translate-y-1"
                          x-model="textProperties.stroke"
                          @input="updateObjectProperty('stroke', $event.target.value)"
                        />
                      </div>
                      <input
                        type="number"
                        class="w-12 bg-gray-100 rounded text-center px-1 py-0.5 text-sm"
                        x-model="textProperties.strokeWidth"
                        readonly
                      />
                    </div>
                  </div>
                  <input
                    type="range"
                    class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                    min="0"
                    max="2"
                    step="0.1"
                    x-model="textProperties.strokeWidth"
                    @input="updateObjectProperty('strokeWidth', $event.target.value)"
                  />
                </div>

                <!-- Letter Spacing -->
                <div class="space-y-1">
                  <div class="flex justify-between items-center">
                    <span class="text-sm font-medium">Letter Spacing</span>
                    <input
                      type="number"
                      class="w-12 bg-gray-100 rounded text-center px-1 py-0.5 text-sm"
                      x-model="textProperties.charSpacing"
                      readonly
                    />
                  </div>
                  <input
                    type="range"
                    class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                    min="0"
                    max="500"
                    x-model="textProperties.charSpacing"
                    @input="updateObjectProperty('charSpacing', $event.target.value)"
                  />
                </div>
                <!-- Curve Text -->
                <div class="border border-gray-200 rounded overflow-hidden">
                  <div
                    @click="showCurve = !showCurve"
                    class="flex justify-between items-center p-3 cursor-pointer hover:bg-gray-50"
                  >
                    <div class="flex items-center">
                      <svg
                        class="w-4 h-4 mr-2 transition-transform duration-200"
                        :class="showCurve ? 'rotate-90' : ''"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 -960 960 960"
                      >
                        <path
                          fill="currentColor"
                          d="M504-480 320-664l56-56 240 240-240 240-56-56 184-184Z"
                        />
                      </svg>
                      <span class="text-sm font-medium">Curve Text</span>
                    </div>
                  </div>

                  <div
                    x-show="showCurve"
                    x-transition
                    class="p-3 border-t border-gray-200 space-y-3"
                  >
                    <!-- Curve Text Slider -->
                    <div class="space-y-1">
                      <div class="flex justify-between items-center">
                        <span class="text-sm font-medium">Curve Angle</span>
                        <input
                          type="number"
                          class="w-16 bg-gray-100 rounded text-center px-2 py-1 text-sm"
                          x-model="curveAngle"
                          @change="updateCurveFromAngle($event.target.value)"
                        />
                      </div>
                      <input
                        type="range"
                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="0"
                        max="5000"
                        x-model="curveValue"
                        @input="updateTextCurve($event.target.value)"
                      />
                    </div>
                  </div>
                </div>

                <!-- Distortion -->
                <div class="border border-gray-200 rounded overflow-hidden">
                  <div
                    @click="showDistortion = !showDistortion"
                    class="flex justify-between items-center p-3 cursor-pointer hover:bg-gray-50"
                  >
                    <div class="flex items-center">
                      <svg
                        class="w-4 h-4 mr-2 transition-transform duration-200"
                        :class="showDistortion ? 'rotate-90' : ''"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 -960 960 960"
                      >
                        <path
                          fill="currentColor"
                          d="M504-480 320-664l56-56 240 240-240 240-56-56 184-184Z"
                        />
                      </svg>
                      <span class="text-sm font-medium">Distortion</span>
                    </div>
                  </div>

                  <div
                    x-show="showDistortion"
                    x-transition
                    class="p-3 border-t border-gray-200 space-y-3"
                  >
                    <!-- SkewX -->
                    <div class="space-y-1">
                      <div class="flex justify-between items-center">
                        <span class="text-sm font-medium">SkewX</span>
                        <input
                          type="text"
                          class="w-12 bg-gray-100 rounded text-center px-1 py-0.5 text-sm"
                          x-model="textProperties.skewX"
                        />
                      </div>
                      <input
                        type="range"
                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="0"
                        max="180"
                        x-model="textProperties.skewX"
                        @input="updateObjectProperty('skewX', $event.target.value)"
                      />
                    </div>

                    <!-- SkewY -->
                    <div class="space-y-1">
                      <div class="flex justify-between items-center">
                        <span class="text-sm font-medium">SkewY</span>
                        <input
                          type="text"
                          class="w-12 bg-gray-100 rounded text-center px-1 py-0.5 text-sm"
                          x-model="textProperties.skewY"
                        />
                      </div>
                      <input
                        type="range"
                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="0"
                        max="180"
                        x-model="textProperties.skewY"
                        @input="updateObjectProperty('skewY', $event.target.value)"
                      />
                    </div>
                  </div>
                </div>

                <!-- Shadow -->
                <div class="border border-gray-200 rounded overflow-hidden">
                  <div
                    @click="showShadow = !showShadow"
                    class="flex justify-between items-center p-3 cursor-pointer hover:bg-gray-50"
                  >
                    <div class="flex items-center">
                      <svg
                        class="w-4 h-4 mr-2 transition-transform duration-200"
                        :class="showShadow ? 'rotate-90' : ''"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 -960 960 960"
                      >
                        <path
                          fill="currentColor"
                          d="M504-480 320-664l56-56 240 240-240 240-56-56 184-184Z"
                        />
                      </svg>
                      <span class="text-sm font-medium">Shadow</span>
                    </div>
                    <div
                      class="relative inline-block w-10 align-middle select-none"
                    >
                      <input
                        type="checkbox"
                        id="shadow-toggle-text"
                        name="shadow-toggle"
                        class="sr-only peer"
                        x-model="textProperties.shadowEnabled"
                        @change="toggleShadow"
                      />
                      <label
                        for="shadow-toggle-text"
                        class="block h-6 overflow-hidden bg-gray-300 rounded-full cursor-pointer peer-checked:bg-blue-500 peer-checked:after:translate-x-4 after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all"
                      >
                      </label>
                    </div>
                  </div>

                  <div
                    x-show="showShadow && textProperties.shadowEnabled"
                    x-transition
                    class="p-3 border-t border-gray-200 space-y-3"
                  >
                    <!-- Shadow Color -->
                    <div class="space-y-1">
                      <span class="text-sm font-medium">Color</span>
                      <div
                        class="w-full h-8 rounded border border-gray-300 overflow-hidden"
                      >
                        <input
                          type="color"
                          class="w-full h-10 transform -translate-y-1"
                          x-model="textProperties.shadowColor"
                          @input="updateShadow('color', $event.target.value)"
                        />
                      </div>
                    </div>

                    <!-- Shadow Blur -->
                    <div class="space-y-1">
                      <div class="flex justify-between items-center">
                        <span class="text-sm font-medium">Blur</span>
                        <input
                          type="number"
                          class="w-12 bg-gray-100 rounded text-center px-1 py-0.5 text-sm"
                          x-model="textProperties.shadowBlur"
                          readonly
                        />
                      </div>
                      <input
                        type="range"
                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="0"
                        max="50"
                        x-model="textProperties.shadowBlur"
                        @input="updateShadow('blur', $event.target.value)"
                      />
                    </div>

                    <!-- Shadow OffsetX -->
                    <div class="space-y-1">
                      <div class="flex justify-between items-center">
                        <span class="text-sm font-medium">OffsetX</span>
                        <input
                          type="number"
                          class="w-12 bg-gray-100 rounded text-center px-1 py-0.5 text-sm"
                          x-model="textProperties.shadowOffsetX"
                          readonly
                        />
                      </div>
                      <input
                        type="range"
                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="-100"
                        max="100"
                        x-model="textProperties.shadowOffsetX"
                        @input="updateShadow('offsetX', $event.target.value)"
                      />
                    </div>

                    <!-- Shadow OffsetY -->
                    <div class="space-y-1">
                      <div class="flex justify-between items-center">
                        <span class="text-sm font-medium">OffsetY</span>
                        <input
                          type="number"
                          class="w-12 bg-gray-100 rounded text-center px-1 py-0.5 text-sm"
                          x-model="textProperties.shadowOffsetY"
                          readonly
                        />
                      </div>
                      <input
                        type="range"
                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="-100"
                        max="100"
                        x-model="textProperties.shadowOffsetY"
                        @input="updateShadow('offsetY', $event.target.value)"
                      />
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Drawing Panel -->
          <div
            x-data="drawingPanel"
            x-show="isActive"
            @tool-changed.window="isActive = $event.detail.type === 'drawing'"
            class="h-full flex flex-col"
          >
            <!-- Panel Header -->
            <div class="p-4 border-b border-gray-200">
              <h3 class="text-lg font-medium text-gray-800">Drawing</h3>
            </div>

            <!-- Panel Body -->
            <div class="flex-1 overflow-y-auto p-4">
              <!-- Tabs -->
              <div class="space-y-4">
                <!-- Tab Buttons -->
                <div class="flex space-x-2 border-b border-gray-200">
                  <button
                    @click="activeTab = 'brush'; updateDrawingMode('brush')"
                    :class="activeTab === 'brush' ? 'bg-gray-100 border-b-2 border-blue-500' : 'hover:bg-gray-50'"
                    class="flex items-center justify-center p-3 rounded-t"
                  >
                    <svg
                      class="w-[17px] h-[17px] text-gray-700"
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 512 512"
                    >
                      <path
                        fill="currentColor"
                        d="M167.02 309.34c-40.12 2.58-76.53 17.86-97.19 72.3-2.35 6.21-8 9.98-14.59 9.98-11.11 0-45.46-27.67-55.25-34.35C0 439.62 37.93 512 128 512c75.86 0 128-43.77 128-120.19 0-3.11-.65-6.08-.97-9.13l-88.01-73.34zM457.89 0c-15.16 0-29.37 6.71-40.21 16.45C213.27 199.05 192 203.34 192 257.09c0 13.7 3.25 26.76 8.73 38.7l63.82 53.18c7.21 1.8 14.64 3.03 22.39 3.03 62.11 0 98.11-45.47 211.16-256.46 7.38-14.35 13.9-29.85 13.9-45.99C512 20.64 486 0 457.89 0z"
                      />
                    </svg>
                  </button>
                  <button
                    @click="activeTab = 'eraser'; updateDrawingMode('eraser')"
                    :class="activeTab === 'eraser' ? 'bg-gray-100 border-b-2 border-blue-500' : 'hover:bg-gray-50'"
                    class="flex items-center justify-center p-3 rounded-t"
                  >
                    <svg
                      class="w-[17px] h-[17px] text-gray-700"
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 512 512"
                    >
                      <path
                        fill="currentColor"
                        d="M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"
                      />
                    </svg>
                  </button>
                  <button
                    @click="activeTab = 'pencil'; updateDrawingMode('pencil')"
                    :class="activeTab === 'pencil' ? 'bg-gray-100 border-b-2 border-blue-500' : 'hover:bg-gray-50'"
                    class="flex items-center justify-center p-3 rounded-t"
                  >
                    <svg
                      class="w-[17px] h-[17px] text-gray-700"
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 512 512"
                    >
                      <path
                        fill="currentColor"
                        d="M79.18 282.94a32.005 32.005 0 0 0-20.24 20.24L0 480l4.69 4.69 92.89-92.89c-.66-2.56-1.57-5.03-1.57-7.8 0-17.67 14.33-32 32-32s32 14.33 32 32-14.33 32-32 32c-2.77 0-5.24-.91-7.8-1.57l-92.89 92.89L32 512l176.82-58.94a31.983 31.983 0 0 0 20.24-20.24l33.07-84.07-98.88-98.88-84.07 33.07zM369.25 28.32L186.14 227.81l97.85 97.85 199.49-183.11C568.4 67.48 443.73-55.94 369.25 28.32z"
                      />
                    </svg>
                  </button>
                </div>

                <!-- Tab Panels -->
                <div class="mt-4">
                  <!-- Brush Panel -->
                  <div x-show="activeTab === 'brush'" class="space-y-5">
                    <!-- Brush Preview -->
                    <div
                      class="bg-gray-100 rounded flex items-center justify-center p-4 h-24"
                    >
                      <div
                        class="rounded-full"
                        :style="`background-color: ${brushSettings.color}; width: ${brushSettings.size}px; height: ${brushSettings.size}px; opacity: ${brushSettings.opacity}`"
                      ></div>
                    </div>

                    <!-- Brush Size -->
                    <div class="space-y-1">
                      <div class="flex justify-between items-center">
                        <span class="text-sm font-medium">Brush Size</span>
                        <input
                          type="number"
                          class="w-16 bg-gray-100 rounded text-center px-2 py-1 text-sm"
                          x-model="brushSettings.size"
                          @input="setupBrush()"
                          min="1"
                          max="100"
                        />
                      </div>
                      <input
                        type="range"
                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="1"
                        max="100"
                        x-model="brushSettings.size"
                        @input="setupBrush()"
                        @change="setupBrush()"
                      />
                    </div>

                    <!-- Opacity -->
                    <div class="space-y-1">
                      <div class="flex justify-between items-center">
                        <span class="text-sm font-medium">Opacity</span>
                        <input
                          type="number"
                          class="w-16 bg-gray-100 rounded text-center px-2 py-1 text-sm"
                          x-model="brushSettings.opacity"
                          @input="setupBrush()"
                          min="0"
                          max="1"
                          step="0.1"
                        />
                      </div>
                      <input
                        type="range"
                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="0"
                        max="1"
                        step="0.1"
                        x-model="brushSettings.opacity"
                        @input="setupBrush()"
                        @change="setupBrush()"
                      />
                    </div>

                    <!-- Color -->
                    <div class="space-y-1">
                      <span class="text-sm font-medium">Color</span>
                      <div
                        class="w-full h-10 rounded border border-gray-300 overflow-hidden"
                      >
                        <input
                          type="color"
                          class="w-full h-12 transform -translate-y-1"
                          x-model="brushSettings.color"
                          @input="setupBrush()"
                          @change="setupBrush()"
                        />
                      </div>
                    </div>
                  </div>

                  <!-- Eraser Panel -->
                  <div x-show="activeTab === 'eraser'" class="space-y-5">
                    <!-- Invert Eraser Toggle -->
                    <div class="flex justify-between items-center">
                      <span class="text-sm font-medium">Invert Eraser</span>
                      <div
                        class="relative inline-block w-10 align-middle select-none"
                      >
                        <input
                          type="checkbox"
                          id="invert-eraser"
                          class="sr-only peer"
                          x-model="eraserSettings.invert"
                          @change="setupEraser()"
                        />
                        <label
                          for="invert-eraser"
                          class="block h-6 overflow-hidden bg-gray-300 rounded-full cursor-pointer peer-checked:bg-blue-500 peer-checked:after:translate-x-4 after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all"
                        >
                        </label>
                      </div>
                    </div>

                    <!-- Eraser Preview -->
                    <div
                      class="bg-gray-100 rounded flex items-center justify-center p-4 h-24"
                    >
                      <div
                        class="rounded-full border-2 border-dashed border-gray-600"
                        :style="`width: ${eraserSettings.size}px; height: ${eraserSettings.size}px;`"
                      ></div>
                    </div>

                    <!-- Size -->
                    <div class="space-y-1">
                      <div class="flex justify-between items-center">
                        <span class="text-sm font-medium">Size</span>
                        <input
                          type="number"
                          class="w-16 bg-gray-100 rounded text-center px-2 py-1 text-sm"
                          x-model="eraserSettings.size"
                          @input="setupEraser()"
                          min="1"
                          max="100"
                        />
                      </div>
                      <input
                        type="range"
                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="1"
                        max="100"
                        x-model="eraserSettings.size"
                        @input="setupEraser()"
                        @change="setupEraser()"
                      />
                    </div>
                  </div>

                  <!-- Pencil Panel -->
                  <div x-show="activeTab === 'pencil'" class="space-y-5">
                    <!-- Brush Type Dropdown -->
                    <div x-data="{ open: false }" class="relative">
                      <div
                        @click="open = !open"
                        class="flex items-center justify-between p-2 bg-gray-100 rounded cursor-pointer"
                      >
                        <span x-text="pencilSettings.brushType">Pencil</span>
                        <svg
                          class="w-4 h-4 transition-transform"
                          :class="open ? 'rotate-180' : ''"
                          xmlns="http://www.w3.org/2000/svg"
                          viewBox="0 -960 960 960"
                        >
                          <path
                            fill="currentColor"
                            d="M480-333 240-573l51-51 189 189 189-189 51 51-240 240Z"
                          />
                        </svg>
                      </div>

                      <div
                        x-show="open"
                        @click.away="open = false"
                        x-transition
                        class="absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded shadow-lg max-h-60 overflow-y-auto"
                      >
                        <div
                          @click="pencilSettings.brushType = 'Pencil'; open = false; setupPencil()"
                          class="p-2 hover:bg-gray-100 cursor-pointer"
                          :class="pencilSettings.brushType === 'Pencil' ? 'bg-gray-100' : ''"
                        >
                          Pencil
                        </div>
                        <div
                          @click="pencilSettings.brushType = 'Circle'; open = false; setupPencil()"
                          class="p-2 hover:bg-gray-100 cursor-pointer"
                          :class="pencilSettings.brushType === 'Circle' ? 'bg-gray-100' : ''"
                        >
                          Circle
                        </div>
                        <div
                          @click="pencilSettings.brushType = 'Spray'; open = false; setupPencil()"
                          class="p-2 hover:bg-gray-100 cursor-pointer"
                          :class="pencilSettings.brushType === 'Spray' ? 'bg-gray-100' : ''"
                        >
                          Spray
                        </div>
                        <div
                          @click="pencilSettings.brushType = 'hLine'; open = false; setupPencil()"
                          class="p-2 hover:bg-gray-100 cursor-pointer"
                          :class="pencilSettings.brushType === 'hLine' ? 'bg-gray-100' : ''"
                        >
                          H Line
                        </div>
                        <div
                          @click="pencilSettings.brushType = 'vLine'; open = false; setupPencil()"
                          class="p-2 hover:bg-gray-100 cursor-pointer"
                          :class="pencilSettings.brushType === 'vLine' ? 'bg-gray-100' : ''"
                        >
                          V Line
                        </div>
                        <div
                          @click="pencilSettings.brushType = 'square'; open = false; setupPencil()"
                          class="p-2 hover:bg-gray-100 cursor-pointer"
                          :class="pencilSettings.brushType === 'square' ? 'bg-gray-100' : ''"
                        >
                          Square
                        </div>
                        <div
                          @click="pencilSettings.brushType = 'diamond'; open = false; setupPencil()"
                          class="p-2 hover:bg-gray-100 cursor-pointer"
                          :class="pencilSettings.brushType === 'diamond' ? 'bg-gray-100' : ''"
                        >
                          Diamond
                        </div>
                        <div
                          @click="pencilSettings.brushType = 'texture'; open = false; setupPencil()"
                          class="p-2 hover:bg-gray-100 cursor-pointer"
                          :class="pencilSettings.brushType === 'texture' ? 'bg-gray-100' : ''"
                        >
                          Texture
                        </div>
                      </div>
                    </div>

                    <!-- Size -->
                    <div class="space-y-1">
                      <div class="flex justify-between items-center">
                        <span class="text-sm font-medium">Size</span>
                        <input
                          type="number"
                          class="w-16 bg-gray-100 rounded text-center px-2 py-1 text-sm"
                          x-model="pencilSettings.size"
                          @input="setupPencil()"
                          min="1"
                          max="100"
                        />
                      </div>
                      <input
                        type="range"
                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="1"
                        max="100"
                        x-model="pencilSettings.size"
                        @input="setupPencil()"
                        @change="setupPencil()"
                      />
                    </div>

                    <!-- Shadow Width -->
                    <div class="space-y-1">
                      <div class="flex justify-between items-center">
                        <span class="text-sm font-medium"
                          >Drawing Shadow Width</span
                        >
                        <input
                          type="number"
                          class="w-16 bg-gray-100 rounded text-center px-2 py-1 text-sm"
                          x-model="pencilSettings.shadowWidth"
                          @input="setupPencil()"
                          min="0"
                          max="50"
                        />
                      </div>
                      <input
                        type="range"
                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="0"
                        max="50"
                        x-model="pencilSettings.shadowWidth"
                        @input="setupPencil()"
                        @change="setupPencil()"
                      />
                    </div>

                    <!-- Shadow Offset X -->
                    <div class="space-y-1">
                      <div class="flex justify-between items-center">
                        <span class="text-sm font-medium">Shadow Offset X</span>
                        <input
                          type="number"
                          class="w-16 bg-gray-100 rounded text-center px-2 py-1 text-sm"
                          x-model="pencilSettings.shadowOffsetX"
                          @input="setupPencil()"
                          min="0"
                          max="50"
                        />
                      </div>
                      <input
                        type="range"
                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="0"
                        max="50"
                        x-model="pencilSettings.shadowOffsetX"
                        @input="setupPencil()"
                        @change="setupPencil()"
                      />
                    </div>

                    <!-- Shadow Offset Y -->
                    <div class="space-y-1">
                      <div class="flex justify-between items-center">
                        <span class="text-sm font-medium">Shadow Offset Y</span>
                        <input
                          type="number"
                          class="w-16 bg-gray-100 rounded text-center px-2 py-1 text-sm"
                          x-model="pencilSettings.shadowOffsetY"
                          @input="setupPencil()"
                          min="0"
                          max="50"
                        />
                      </div>
                      <input
                        type="range"
                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="0"
                        max="50"
                        x-model="pencilSettings.shadowOffsetX"
                        @input="setupPencil()"
                        @change="setupPencil()"
                      />
                    </div>

                    <!-- Drawing Color -->
                    <div class="space-y-1">
                      <span class="text-sm font-medium">Drawing Color</span>
                      <div
                        class="w-full h-10 rounded border border-gray-300 overflow-hidden"
                      >
                        <input
                          type="color"
                          class="w-full h-12 transform -translate-y-1"
                          x-model="pencilSettings.color"
                          @input="setupPencil()"
                          @change="setupPencil()"
                        />
                      </div>
                    </div>

                    <!-- Drawing Shadow Color -->
                    <div class="space-y-1">
                      <span class="text-sm font-medium"
                        >Drawing Shadow Color</span
                      >
                      <div
                        class="w-full h-10 rounded border border-gray-300 overflow-hidden"
                      >
                        <input
                          type="color"
                          class="w-full h-12 transform -translate-y-1"
                          x-model="pencilSettings.shadowColor"
                          @input="setupPencil()"
                          @change="setupPencil()"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Settings Panel -->
          <div
            x-data="settingsPanel"
            x-show="isActive"
            @tool-changed.window="isActive = $event.detail.type === 'settings'"
            class="h-full flex flex-col"
          >
            <!-- Panel Header -->
            <div class="p-4 border-b border-gray-200">
              <h3 class="text-lg font-medium text-gray-800">Settings</h3>
            </div>

            <!-- Panel Body -->
            <div class="flex-1 overflow-y-auto p-4 space-y-6">
              <!-- Canvas Size -->
              <div class="space-y-2">
                <span class="text-sm font-medium">Canvas Size</span>

                <!-- Canvas Size Dropdown -->
                <div
                  x-data="{
          open: false,
          search: '',
          selected: 'TikTok (1080x1920)',
          value: '1080x1920',
          filteredSizes: []
        }"
                  class="relative"
                >
                  <div
                    @click="open = !open"
                    class="flex items-center justify-between p-2 bg-gray-100 rounded cursor-pointer"
                  >
                    <span x-text="selected">TikTok (1080x1920)</span>
                    <svg
                      class="w-4 h-4 transition-transform"
                      :class="open ? 'rotate-180' : ''"
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 -960 960 960"
                    >
                      <path
                        fill="currentColor"
                        d="M480-333 240-573l51-51 189 189 189-189 51 51-240 240Z"
                      />
                    </svg>
                  </div>

                  <div
                    x-show="open"
                    @click.away="open = false"
                    x-transition
                    class="absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded shadow-lg"
                  >
                    <!-- Search Bar -->
                    <div class="p-2 border-b border-gray-200">
                      <input
                        type="text"
                        x-model="search"
                        @input="filterSizes()"
                        placeholder="Search here..."
                        class="w-full p-2 border border-gray-300 rounded"
                      />
                    </div>

                    <!-- Size List -->
                    <div class="max-h-60 overflow-y-auto p-1">
                      <template
                        x-for="size in search ? filteredSizes : canvasSizes"
                        :key="size.key"
                      >
                        <div
                          @click="selectSize(size); open = false"
                          class="p-2 hover:bg-gray-100 rounded cursor-pointer"
                          :class="value === size.value ? 'bg-gray-100' : ''"
                        >
                          <span x-text="size.name"></span>
                        </div>
                      </template>
                    </div>
                  </div>
                </div>

                <!-- Custom Size -->
                <div
                  x-show="customSizeVisible"
                  x-transition
                  class="space-y-3 pt-2 mt-2 border-t border-gray-200"
                >
                  <div class="grid grid-cols-2 gap-3">
                    <!-- Width -->
                    <div class="space-y-1">
                      <span class="text-sm font-medium">Width:</span>
                      <input
                        type="number"
                        x-model="customWidth"
                        placeholder="Width here..."
                        class="w-full p-2 border border-gray-300 rounded"
                      />
                    </div>

                    <!-- Height -->
                    <div class="space-y-1">
                      <span class="text-sm font-medium">Height:</span>
                      <input
                        type="number"
                        x-model="customHeight"
                        placeholder="Height here..."
                        class="w-full p-2 border border-gray-300 rounded"
                      />
                    </div>
                  </div>

                  <div>
                    <button
                      @click="applyCustomSize()"
                      class="flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition"
                    >
                      <svg
                        class="w-4 h-4"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 -960 960 960"
                      >
                        <path
                          fill="currentColor"
                          d="M382-240 154-468l57-57 171 171 367-367 57 57-424 424Z"
                        />
                      </svg>
                      Apply
                    </button>
                  </div>
                </div>
              </div>

              <!-- Background Color -->
              <div class="space-y-2">
                <span class="text-sm font-medium">Background Color</span>
                <div
                  class="w-full h-10 rounded border border-gray-300 overflow-hidden"
                >
                  <input
                    type="color"
                    x-model="backgroundColor"
                    @input="updateBackgroundColor()"
                    class="w-full h-12 transform -translate-y-1"
                  />
                </div>
              </div>
            </div>
          </div>
          <!-- Layers Panel -->
          <div
            x-data="layersPanel"
            x-show="isActive"
            @tool-changed.window="isActive = $event.detail.type === 'layers'"
            class="h-full flex flex-col"
          >
            <!-- Panel Header -->
            <div class="p-4 border-b border-gray-200">
              <h3 class="text-lg font-medium text-gray-800">Layers</h3>
            </div>

            <!-- Panel Body -->
            <div class="flex-1 overflow-y-auto p-4">
              <!-- Layers Container -->
              <div class="space-y-2">
                <template x-if="layers.length > 0">
                  <div class="space-y-2">
                    <template x-for="(layer, index) in layers" :key="layer.id">
                      <div
                        @click="selectLayer(layer)"
                        :class="selectedLayerId === layer.id ? 'bg-blue-50 border-blue-300' : 'hover:bg-gray-50'"
                        class="p-2 border border-gray-200 rounded flex items-center justify-between cursor-pointer transition-colors"
                      >
                        <div class="flex items-center space-x-2">
                          <div
                            :class="layer.visible ? 'text-blue-500' : 'text-gray-400'"
                            @click.stop="toggleLayerVisibility(layer)"
                            class="cursor-pointer"
                          >
                            <svg
                              class="w-5 h-5"
                              xmlns="http://www.w3.org/2000/svg"
                              viewBox="0 0 24 24"
                              fill="currentColor"
                            >
                              <path
                                d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"
                              />
                            </svg>
                          </div>
                          <span
                            x-text="layer.name || `Layer ${index + 1}`"
                            class="truncate max-w-[180px]"
                          ></span>
                        </div>
                        <div class="flex space-x-1">
                          <button
                            @click.stop="moveLayerUp(index)"
                            :disabled="index === 0"
                            :class="index === 0 ? 'text-gray-300 cursor-not-allowed' : 'text-gray-600 hover:text-gray-900'"
                            class="p-1 rounded hover:bg-gray-100"
                          >
                            <svg
                              class="w-4 h-4"
                              xmlns="http://www.w3.org/2000/svg"
                              viewBox="0 0 24 24"
                              fill="currentColor"
                            >
                              <path
                                d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"
                              />
                            </svg>
                          </button>
                          <button
                            @click.stop="moveLayerDown(index)"
                            :disabled="index === layers.length - 1"
                            :class="index === layers.length - 1 ? 'text-gray-300 cursor-not-allowed' : 'text-gray-600 hover:text-gray-900'"
                            class="p-1 rounded hover:bg-gray-100"
                          >
                            <svg
                              class="w-4 h-4"
                              xmlns="http://www.w3.org/2000/svg"
                              viewBox="0 0 24 24"
                              fill="currentColor"
                            >
                              <path
                                d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"
                              />
                            </svg>
                          </button>
                          <button
                            @click.stop="deleteLayer(layer)"
                            class="p-1 rounded hover:bg-gray-100 text-gray-600 hover:text-red-500"
                          >
                            <svg
                              class="w-4 h-4"
                              xmlns="http://www.w3.org/2000/svg"
                              viewBox="0 0 24 24"
                              fill="currentColor"
                            >
                              <path
                                d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"
                              />
                            </svg>
                          </button>
                        </div>
                      </div>
                    </template>
                  </div>
                </template>

                <!-- Empty state -->
                <div
                  x-show="layers.length === 0"
                  class="text-center text-gray-500 py-8"
                >
                  No layers found!
                </div>
              </div>
            </div>
          </div>
          <!-- Clip Arts Panel -->
          <div
            x-data="clipArtsPanel"
            x-show="isActive"
            @tool-changed.window="isActive = $event.detail.type === 'clip_arts'"
            class="h-full flex flex-col"
          >
            <!-- Panel Header -->
            <div class="p-4 border-b border-gray-200">
              <h3 class="text-lg font-medium text-gray-800">Clip Arts</h3>
            </div>

            <!-- Panel Body -->
            <div class="flex-1 overflow-y-auto p-4">
              <!-- Media Component -->
              <div class="grid grid-cols-3 gap-3">
                <!-- Clip Art Items -->
                <div
                  @click="addClipArt('./images/clip_arts/1.png')"
                  class="aspect-square bg-gray-50 border border-gray-200 rounded overflow-hidden hover:border-blue-400 cursor-pointer transition"
                >
                  <img
                    src="./images/clip_arts/1.png"
                    alt="Clip art 1"
                    class="w-full h-full object-contain p-2"
                  />
                </div>

                <div
                  @click="addClipArt('./images/clip_arts/2.png')"
                  class="aspect-square bg-gray-50 border border-gray-200 rounded overflow-hidden hover:border-blue-400 cursor-pointer transition"
                >
                  <img
                    src="./images/clip_arts/2.png"
                    alt="Clip art 2"
                    class="w-full h-full object-contain p-2"
                  />
                </div>

                <div
                  @click="addClipArt('./images/clip_arts/3.png')"
                  class="aspect-square bg-gray-50 border border-gray-200 rounded overflow-hidden hover:border-blue-400 cursor-pointer transition"
                >
                  <img
                    src="./images/clip_arts/3.png"
                    alt="Clip art 3"
                    class="w-full h-full object-contain p-2"
                  />
                </div>
              </div>
            </div>
          </div>
          <!-- Mask Panel -->
          <div
            x-data="maskPanel"
            x-show="isActive"
            @tool-changed.window="isActive = $event.detail.type === 'mask'"
            class="h-full flex flex-col"
          >
            <!-- Panel Header -->
            <div class="p-4 border-b border-gray-200">
              <h3 class="text-lg font-medium text-gray-800">Mask</h3>
            </div>

            <!-- Panel Body -->
            <div class="flex-1 overflow-y-auto p-4">
              <!-- Media Component -->
              <div class="grid grid-cols-3 gap-3">
                <!-- Mask Items -->
                <div
                  @click="applyMask('./images/mask/1.svg')"
                  class="aspect-square bg-gray-50 border border-gray-200 rounded overflow-hidden hover:border-blue-400 cursor-pointer transition"
                >
                  <img
                    src="./images/mask/1.svg"
                    alt="Mask 1"
                    class="w-full h-full object-contain p-2"
                  />
                </div>

                <div
                  @click="applyMask('./images/mask/2.svg')"
                  class="aspect-square bg-gray-50 border border-gray-200 rounded overflow-hidden hover:border-blue-400 cursor-pointer transition"
                >
                  <img
                    src="./images/mask/2.svg"
                    alt="Mask 2"
                    class="w-full h-full object-contain p-2"
                  />
                </div>

                <div
                  @click="applyMask('./images/mask/3.svg')"
                  class="aspect-square bg-gray-50 border border-gray-200 rounded overflow-hidden hover:border-blue-400 cursor-pointer transition"
                >
                  <img
                    src="./images/mask/3.svg"
                    alt="Mask 3"
                    class="w-full h-full object-contain p-2"
                  />
                </div>

                <div
                  @click="applyMask('./images/mask/5.svg')"
                  class="aspect-square bg-gray-50 border border-gray-200 rounded overflow-hidden hover:border-blue-400 cursor-pointer transition"
                >
                  <img
                    src="./images/mask/5.svg"
                    alt="Mask 5"
                    class="w-full h-full object-contain p-2"
                  />
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!--canvas area-->
      <div class="relative w-full h-full overflow-auto">
        <!-- Quick Options Bar -->
        <div
          x-data="quickOptionsBar"
          class="absolute top-4 left-1/2 transform -translate-x-1/2 bg-white rounded-full shadow-md px-2 py-1 flex items-center gap-1 z-10"
        >
          <!-- Canvas Alignment -->
          <div
            class="flex items-center"
            :class="{'opacity-50 pointer-events-none': !hasSelection}"
          >
            <!-- Left -->
            <button
              @click="alignObjects('left')"
              class="p-2 rounded-full hover:bg-gray-100 transition"
            >
              <svg
                class="w-[17px] h-[17px] text-gray-700"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
              >
                <path
                  fill="currentColor"
                  d="M4 3c.41 0 .75.34.75.75v16.5a.75.75 0 1 1-1.5 0V3.75c0-.41.34-.75.75-.75zm5 3h9a2 2 0 0 1 2 2v1a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V8c0-1.1.9-2 2-2zm0 7h4a2 2 0 0 1 2 2v1a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2v-1c0-1.1.9-2 2-2zm0-5.5a.5.5 0 0 0-.5.5v1c0 .28.22.5.5.5h9a.5.5 0 0 0 .5-.5V8a.5.5 0 0 0-.5-.5H9zm0 7a.5.5 0 0 0-.5.5v1c0 .28.22.5.5.5h4a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5H9z"
                />
              </svg>
            </button>

            <!-- Center Horizontal -->
            <button
              @click="alignObjects('centerH')"
              class="p-2 rounded-full hover:bg-gray-100 transition"
            >
              <svg
                class="w-[17px] h-[17px] text-gray-700"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
              >
                <path
                  fill="currentColor"
                  d="M11.25 13v-2H7a2 2 0 0 1-2-2V8c0-1.1.9-2 2-2h4.25V3.75a.75.75 0 1 1 1.5 0V6H17a2 2 0 0 1 2 2v1a2 2 0 0 1-2 2h-4.25v2H14a2 2 0 0 1 2 2v1a2 2 0 0 1-2 2h-1.25v2.25a.75.75 0 1 1-1.5 0V18H10a2 2 0 0 1-2-2v-1c0-1.1.9-2 2-2h1.25zM7 7.5a.5.5 0 0 0-.5.5v1c0 .28.22.5.5.5h10a.5.5 0 0 0 .5-.5V8a.5.5 0 0 0-.5-.5H7zm3 7a.5.5 0 0 0-.5.5v1c0 .28.22.5.5.5h4a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-4z"
                />
              </svg>
            </button>

            <!-- Right -->
            <button
              @click="alignObjects('right')"
              class="p-2 rounded-full hover:bg-gray-100 transition"
            >
              <svg
                class="w-[17px] h-[17px] text-gray-700"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
              >
                <path
                  fill="currentColor"
                  d="M20 3a.75.75 0 0 0-.75.75v16.5a.75.75 0 1 0 1.5 0V3.75A.75.75 0 0 0 20 3zm-5 3H6a2 2 0 0 0-2 2v1c0 1.1.9 2 2 2h9a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2zm0 7h-4a2 2 0 0 0-2 2v1c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2v-1a2 2 0 0 0-2-2zm0-5.5c.28 0 .5.22.5.5v1a.5.5 0 0 1-.5.5H6a.5.5 0 0 1-.5-.5V8c0-.28.22-.5.5-.5h9zm0 7c.28 0 .5.22.5.5v1a.5.5 0 0 1-.5.5h-4a.5.5 0 0 1-.5-.5v-1c0-.28.22-.5.5-.5h4z"
                />
              </svg>
            </button>

            <!-- Top -->
            <button
              @click="alignObjects('top')"
              class="p-2 rounded-full hover:bg-gray-100 transition"
            >
              <svg
                class="w-[17px] h-[17px] text-gray-700"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
              >
                <path
                  fill="currentColor"
                  d="M21 4c0 .41-.34.75-.75.75H3.75a.75.75 0 0 1 0-1.5h16.5c.41 0 .75.34.75.75zM11 9v9a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V9c0-1.1.9-2 2-2h1a2 2 0 0 1 2 2zm7 0v4a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2V9c0-1.1.9-2 2-2h1a2 2 0 0 1 2 2zM9.5 9a.5.5 0 0 0-.5-.5H8a.5.5 0 0 0-.5.5v9c0 .28.22.5.5.5h1a.5.5 0 0 0 .5-.5V9zm7 0a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v4c0 .28.22.5.5.5h1a.5.5 0 0 0 .5-.5V9z"
                />
              </svg>
            </button>

            <!-- Center Vertical -->
            <button
              @click="alignObjects('centerV')"
              class="p-2 rounded-full hover:bg-gray-100 transition"
            >
              <svg
                class="w-[17px] h-[17px] text-gray-700"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
              >
                <path
                  fill="currentColor"
                  d="M11 11.25h2V7c0-1.1.9-2 2-2h1a2 2 0 0 1 2 2v4.25h2.25a.75.75 0 1 1 0 1.5H18V17a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-4.25h-2V14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2v-1.25H3.75a.75.75 0 1 1 0-1.5H6V10c0-1.1.9-2 2-2h1a2 2 0 0 1 2 2v1.25zM16.5 7a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v10c0 .28.22.5.5.5h1a.5.5 0 0 0 .5-.5V7zm-7 3a.5.5 0 0 0-.5-.5H8a.5.5 0 0 0-.5.5v4c0 .28.22.5.5.5h1a.5.5 0 0 0 .5-.5v-4z"
                />
              </svg>
            </button>

            <!-- Bottom -->
            <button
              @click="alignObjects('bottom')"
              class="p-2 rounded-full hover:bg-gray-100 transition"
            >
              <svg
                class="w-[17px] h-[17px] text-gray-700"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
              >
                <path
                  fill="currentColor"
                  d="M21 20c0 .41-.34.75-.75.75H3.75a.75.75 0 1 1 0-1.5h16.5c.41 0 .75.34.75.75zM11 6v9a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h1a2 2 0 0 1 2 2zm7 5v4a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-4c0-1.1.9-2 2-2h1a2 2 0 0 1 2 2zM9.5 6a.5.5 0 0 0-.5-.5H8a.5.5 0 0 0-.5.5v9c0 .28.22.5.5.5h1a.5.5 0 0 0 .5-.5V6zm7 5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v4c0 .28.22.5.5.5h1a.5.5 0 0 0 .5-.5v-4z"
                />
              </svg>
            </button>

            <div class="h-6 w-px bg-gray-300 mx-1"></div>
          </div>

          <!-- Crop Tools -->
          <div class="flex items-center">
            <!-- Start Crop -->
            <button
              x-show="!cropActive && canCrop"
              @click="startCrop"
              :class="{'opacity-50 pointer-events-none': !canCrop}"
              class="p-2 rounded-full hover:bg-gray-100 transition"
            >
              <svg
                class="w-[17px] h-[17px] text-gray-700"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 -960 960 960"
              >
                <path
                  fill="currentColor"
                  d="M680-40v-160H280q-33 0-56.5-23.5T200-280v-400H40v-80h160v-160h80v640h640v80H760v160h-80Zm0-320v-320H360v-80h320q33 0 56.5 23.5T760-680v320h-80Z"
                />
              </svg>
            </button>

            <!-- Apply Crop -->
            <button
              x-show="cropActive"
              @click="applyCrop"
              class="p-2 rounded-full hover:bg-gray-100 transition"
            >
              <svg
                class="w-[17px] h-[17px] text-gray-700"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 -960 960 960"
              >
                <path
                  fill="currentColor"
                  d="M382-240 154-468l57-57 171 171 367-367 57 57-424 424Z"
                />
              </svg>
            </button>

            <!-- Reset Crop -->
            <button
              x-show="cropActive"
              @click="resetCrop"
              class="p-2 rounded-full hover:bg-gray-100 transition"
            >
              <svg
                class="w-[17px] h-[17px] text-gray-700"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 -960 960 960"
              >
                <path
                  fill="currentColor"
                  d="M440-122q-121-15-200.5-105.5T160-440q0-66 26-126.5T260-672l57 57q-38 34-57.5 79T240-440q0 88 56 155.5T440-202v80Zm80 0v-80q87-16 143.5-83T720-440q0-100-70-170t-170-70h-3l44 44-56 56-140-140 140-140 56 56-44 44h3q134 0 227 93t93 227q0 121-79.5 211.5T520-122Z"
                />
              </svg>
            </button>

            <div
              class="h-6 w-px bg-gray-300 mx-1"
              x-show="hasSelection || cropActive"
            ></div>
          </div>

          <!-- Delete -->
          <button
            x-show="hasSelection && !cropActive"
            @click="deleteSelected"
            class="p-2 rounded-full hover:bg-gray-100 transition"
          >
            <svg
              class="w-[14px] h-[14px] text-gray-700"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 448 512"
            >
              <path
                fill="currentColor"
                d="M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1 -32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1 -32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1 -32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.7 23.7 0 0 0 -21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0 -16-16z"
              />
            </svg>
          </button>
        </div>

        <!-- In your HTML, update the canvas container to use this component -->
        <div
          x-data="canvasManager"
          class="border border-gray-300 mx-auto overflow-hidden"
          style="width: 800px; height: 600px"
        >
          <canvas
            id="image-editor"
            x-ref="canvas"
            class="w-full h-full"
          ></canvas>
        </div>
      </div>
    </div>

    <script type="module" src="/js/app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/circletype@2.3.0/dist/circletype.min.js"></script>
  </body>
</html>
